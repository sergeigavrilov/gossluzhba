# Тестовое задание по нагрузочному тестированию для компании Формат Кода

Ссылка на раздел портала, для написания скирпта: https://gossluzhba.gov.ru/news

## Требования к скрипту на Jmeter, сделанного без использования recorder

1. Использовать в скрипте **User Defined Variables**, **HTTP Request Defaults**, **HTTP Header Manager**

2. В качестве языка для Pre и Post процессоров использовать **Groovy**

3. Скрипт принимает на вход property при запуске скрипта через командную строку:

  `jmeter -n -t -JnewsIndex="${newsIndex}" ...`

  если значение не передается, то **newsIndex = 12**

4. По итогу работы скрипт должен класть в **property** с именем **newsText** полный текст новости с порядковым номером newsIndex **без html тэгов**

5. Если новости с таким порядковым номером нет, то **property** с именем **newsText** присваивается текст первой новости и выводится соответствующее предупреждение в консоль

6. При выполнении скрипта не должно быть ошибок в логе Jmeter

7. Сделать открытый репозиторий в github, выложить скрипт и предоставить ссылку для ознакомления

## Примечания к заданию

1. Тестовый скрипт разработан с помощью следующего ПО:
  - Apache Jmeter v. 5.6.2 со стандартным набором компонентов (без сторонних плагинов)
  - OpenJDK v. 11.0.20.1
  - Groovy v. 3.0.17 (используется в Apache Jmeter v. 5.6.2)

2. Поскольку даже в неавторизованной зоне на сайте применяются куки, то в скрипте также использован **HTTP Cookie Manager**

3. Согласно задания, скрипт выполняется в одну итерацию в один поток. Однако, в скрипте предусмотрены настройки для многопоточного запуска и в несколько итераций. Но для такого функционала необходимо скорректировать алгоритм по открытию разных новостных статей

4. В связи с многопоточным функционалом, текст статьи помещается в **property** с именем, зависящим от номера потока: **newsText_\<ThreadNumber\>**

5. Если новости с заданным порядковым номером нет, то берётся текст **первой новости в списке за всё время работы сайта**

6. Для упрощения разработки в рамках тестового задания, отсутствует проверка наличия новостных статей. **То есть _обязательное_ условие - на сайте должна быть создана хотя бы одна статья**.

## Описание кода

Результат выполнения тестового задания - файлы:

- **getNews.jmx** - скрипт для Jmeter с необходимыми тестовыми шагами
- **startNews.sh** - BASH-скрипт для запуска тестового скрипта в режиме консоли

## Подготовка и запуск тестового скрипта

Файлы тестового задания находятся в подпапке **scripts**. Необходимо поместить её в папку **\<JMETER\>** и при необходимости скорректировать пути для запуска этого приложения.

Все параметры, необходимые для запуска тест-скрипта, находятся в начале файла **startNews.sh**, и имеют комментарии об их назначении.

Результаты теста и лог JMeter-a будут сохранены в папке **scripts/testdata**. Для удобства использования, в качестве суффикса для этих файлов добавлены дата и время запуска.
